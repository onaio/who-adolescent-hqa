{% extends 'base.jinja2' %}
{% from 'macros/score_class.jinja2' import score_class %}
{% block title %}{{ clinic.name }}{% endblock %}
{% block content %}
  <div class="table-responsive">
    <table class="table table-bordered table-hover table-striped">
      <thead>
      <tr>
        <th width="5%" class="center-align">#</th>
        <th width="16%">Characteristic</th>
        <th width="7%" class="center-align">Score</th>
        <th width="9%">{# breakdown #}</th>
        {% for client_tool in client_tools %}
          <th width="7%" class="center-align">{{ client_tool.name }}</th>
        {% endfor %}
        <th width="7%" class="center-align">Total</th>
      </tr>
      </thead>
      <tbody>
      {% for characteristic in characteristics %}
        {% set percentage = scores[characteristic.id].totals.total_percentage %}
        <tr>
          <td rowspan="3" class="center-align middle-align">
            <h2>{{ loop.index }}</h2></td>
          <td rowspan="3"
              class="middle-align">{{ characteristic.description }}</td>
          <td rowspan="3" class="center-align middle-align {{ score_class(percentage) }}"><h4
              class="bold">{{ "%(percentage).1f"|format(percentage=percentage) }}%</h4>
          </td>
          <td class="bold">Min - Max</td>
          {% for client_tool in client_tools %}
            <td class="center-align {% if not scores[characteristic.id][client_tool.id] is defined %}active{% endif %}">
              {% if scores[characteristic.id][client_tool.id] is defined %}
                0 -
                {{ scores[characteristic.id][client_tool.id].num_questions }}{% endif %}</td>
          {% endfor %}
          <td width="6%" class="bold center-align">0
            - {{ scores[characteristic.id].totals.total_questions }}</td>
        </tr>
        <tr>
          <td class="bold">Aggregate</td>
          {% for client_tool in client_tools %}
            <td class="center-align {% if not scores[characteristic.id][client_tool.id] is defined %}active{% endif %}">
              {% if scores[characteristic.id][client_tool.id] is defined %}
                {{ scores[characteristic.id][client_tool.id].aggregate_score }}{% endif %}</td>
          {% endfor %}
          <td class="bold center-align">{{ scores[characteristic.id].totals.total_scores }}</td>
        </tr>
        <tr>
          <td class="bold"># Respondents</td>
          {% for client_tool in client_tools %}
            <td class="center-align {% if not scores[characteristic.id][client_tool.id] is defined %}active{% endif %}">
              {% if scores[characteristic.id][client_tool.id] is defined %}
                {{ scores[characteristic.id][client_tool.id].num_responses }}{% endif %}</td>
          {% endfor %}
          <td class="bold center-align">{{ scores[characteristic.id].totals.total_responses }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}